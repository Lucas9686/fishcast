---
phase: 03-fish-catalog-expansion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - fishing-app/js/config.js
  - fishing-app/js/fish-ui.js
  - fishing-app/css/style.css
autonomous: true

must_haves:
  truths:
    - "renderFishDetail displays edibility rating as 1-5 stars"
    - "renderFishDetail displays taste, texture, and preparation tips"
    - "renderFishDetail displays structured habitat info (depth, region, structure)"
    - "Edibility and habitat sections styled consistently with existing dark marine theme"
  artifacts:
    - path: "fishing-app/js/config.js"
      provides: "Extended FishSpecies typedef with edibility object"
      contains: "edibility"
    - path: "fishing-app/js/fish-ui.js"
      provides: "Edibility and habitat rendering in renderFishDetail"
      contains: "edibility"
    - path: "fishing-app/css/style.css"
      provides: "CSS for edibility stars, prep badges, habitat section"
      contains: "edibility"
  key_links:
    - from: "fishing-app/js/fish-ui.js"
      to: "fish.edibility"
      via: "property access in renderFishDetail"
      pattern: "fish\\.edibility"
    - from: "fishing-app/css/style.css"
      to: "fishing-app/js/fish-ui.js"
      via: "CSS class names for edibility elements"
      pattern: "edibility"
---

<objective>
Extend the fish detail view to display edibility/culinary information and structured habitat data.

Purpose: Requirements FISCH-03, FISCH-06, FISCH-07 need UI rendering before data can be validated visually. The schema extension and UI must be in place before the data expansion plans add 140+ new species.
Output: Updated config.js typedef, fish-ui.js with edibility + habitat sections, CSS styles for new sections.
</objective>

<execution_context>
@C:\Users\Lucas Benutzer\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Lucas Benutzer\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@fishing-app/js/config.js
@fishing-app/js/fish-ui.js
@fishing-app/css/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend FishSpecies typedef and add edibility/habitat rendering to fish-ui.js</name>
  <files>fishing-app/js/config.js, fishing-app/js/fish-ui.js</files>
  <action>
  1. In config.js, extend the FishSpecies JSDoc typedef to add:
     ```
     @property {Object} edibility - Kulinarische Informationen
     @property {number} edibility.rating - Essbarkeits-Rating 1-5 (1=nicht essbar, 5=ausgezeichnet)
     @property {string} edibility.taste - Geschmacksprofil ("mild", "medium", "kraeftig", "stark")
     @property {string} edibility.texture - Textur ("zart", "fest", "mager", "fett")
     @property {Array<string>} edibility.preparation - Zubereitungsmethoden
     @property {string} edibility.notes - Besondere kulinarische Hinweise
     @property {Object} [habitatDetail] - Strukturierte Lebensraum-Daten (optional for backward compat)
     @property {string} habitatDetail.depthRange - Tiefenbereich z.B. "0-10m"
     @property {string} habitatDetail.region - Region z.B. "Adria", "Mitteleuropa"
     @property {Array<string>} habitatDetail.structure - Strukturpraeferenzen z.B. ["Felsgrund", "Seegras"]
     ```

  2. In fish-ui.js renderFishDetail function, add an edibility section AFTER the tips section (before the closing of fish-detail__body div). Build the HTML conditionally (only if fish.edibility exists, for backward compatibility with fish entries that don't have it yet):

     - Edibility rating: Display as 1-5 star icons using the same star pattern already used for difficulty (fish-difficulty__star). Use a new class "edibility-star" and "edibility-star--empty".
     - Taste + Texture: Display as inline text "Geschmack: [taste] | Textur: [texture]"
     - Preparation methods: Render as fish-badge elements with class "fish-badge fish-badge--prep"
     - Notes: Render as paragraph if present

     Section title: "Kulinarische Eignung"

  3. In fish-ui.js renderFishDetail, add a habitat detail section AFTER the "Gewaessertypen" badges section. Conditionally render (only if fish.habitatDetail exists):
     - Depth range: "Tiefe: [depthRange]"
     - Region: "Region: [region]"
     - Structure preferences: Render as fish-badge elements

     Section title: "Lebensraum-Details"

  4. Also update the existing habitat rendering to show the fish.habitat string as a paragraph description if it exists (it already does via fish.description, but add it explicitly after water types if fish.habitat is set and non-empty).

  IMPORTANT: Use the same coding style as existing fish-ui.js (var declarations, string concatenation with +, forEach loops, _esc() for escaping). Do NOT use template literals or const/let (maintain consistency).
  </action>
  <verify>
  Open fishing-app/js/config.js and confirm FishSpecies typedef contains edibility and habitatDetail properties.
  Open fishing-app/js/fish-ui.js and confirm renderFishDetail contains edibility rendering code with conditional check (if fish.edibility).
  Grep for "edibility" in both files to confirm presence.
  </verify>
  <done>config.js has extended typedef. fish-ui.js renderFishDetail conditionally renders edibility (stars, taste, texture, preparation badges, notes) and habitatDetail (depth, region, structure). Both use existing code style. Backward compatible - fish without edibility field still render correctly.</done>
</task>

<task type="auto">
  <name>Task 2: Add CSS styles for edibility and habitat sections</name>
  <files>fishing-app/css/style.css</files>
  <action>
  Add CSS rules at the end of the fish detail styles section in style.css (after existing .fish-detail rules). Follow the dark marine theme established in Phase 2:

  1. `.fish-detail__edibility` - Container for edibility section, with slight padding
  2. `.edibility-rating` - Star rating display, inline
  3. `.edibility-star` - Filled star, color: #f59e0b (amber/gold)
  4. `.edibility-star--empty` - Empty star, color: rgba(255,255,255,0.2) for dark theme
  5. `.edibility-info` - Taste/texture text line, color: var(--text-secondary) or rgba(255,255,255,0.7)
  6. `.edibility-notes` - Notes paragraph, font-style: italic, margin-top: 0.5rem
  7. `.fish-badge--prep` - Preparation method badges. Use a distinct color variant from existing fish-badge. Suggestion: background rgba(0, 188, 212, 0.15) with border rgba(0, 188, 212, 0.3) to match marine theme turquoise accents.
  8. `.fish-detail__habitat-detail` - Container for habitat detail section
  9. `.habitat-info` - Text lines for depth/region
  10. `.habitat-info strong` - Bold labels

  Ensure all styles work in both dark and light themes. Dark theme uses :root variables, light theme uses [data-theme="light"]. For the edibility stars, use amber (#f59e0b) in both themes. For empty stars, use rgba(0,0,0,0.15) in light theme.

  Keep consistent spacing with existing fish-detail sections (margin-bottom: 1rem on section titles).
  </action>
  <verify>
  Grep style.css for "edibility" to confirm CSS rules exist.
  Verify both dark and light theme variants are present for edibility stars.
  </verify>
  <done>CSS styles for edibility rating stars, taste/texture info, preparation badges, and habitat detail section exist in style.css. Styles work in both dark and light themes. Visual appearance consistent with existing fish detail sections and dark marine theme.</done>
</task>

</tasks>

<verification>
1. Open fishing-app in browser, navigate to fish detail for any existing fish (e.g., Hecht)
2. Existing detail view should render without errors (no edibility section shown since existing fish lack the field)
3. No JavaScript console errors
4. CSS file loads without syntax errors
</verification>

<success_criteria>
- FishSpecies typedef in config.js includes edibility and habitatDetail
- renderFishDetail conditionally renders edibility section with stars, taste, texture, preparation badges
- renderFishDetail conditionally renders habitatDetail section with depth, region, structure
- CSS styles exist for all new elements in both dark and light themes
- Existing fish entries (without edibility) still render correctly - no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/03-fish-catalog-expansion/03-01-SUMMARY.md`
</output>
